<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AJAX Calculator</title>
   
</head>
<body>
    <div class="calculator">
        <h2>AJAX Calculator</h2>

        <form id="calcForm">
            {% csrf_token %}
            <input type="number" step="any" name="num1" placeholder="Enter first number" required>
            <input type="number" step="any" name="num2" placeholder="Enter second number" required>

            <select name="operation" required>
                <option value="add">Addition (+)</option>
                <option value="subtract">Subtraction (-)</option>
                <option value="multiply">Multiplication (ร)</option>
                <option value="divide">Division (รท)</option>
            </select>

            <button type="submit">Calculate</button>
        </form>

        <h3 id="result"></h3>
        <h3 id="result"></h3>

<hr>
<h4>Recent Calculations:</h4>
<ul id="history">
    {% for calc in history %}
        <li>{{ calc.num1 }} {{ calc.operation }} {{ calc.num2 }} = {{ calc.result }}</li>
    {% empty %}
        <li>No history yet</li>
    {% endfor %}
</ul>

    </div>

   <script>
    const form = document.getElementById("calcForm");
    form.addEventListener("submit", function(event) {
        event.preventDefault();
        const formData = new FormData(form);
        fetch("/calculate/", {
            method: "POST",
            headers: { "X-CSRFToken": formData.get("csrfmiddlewaretoken") },
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("result").innerText = "Result: " + data.result;
            // Reload page section to show updated history
            window.location.reload();
        });
    });
</script>

</body>
</html>
